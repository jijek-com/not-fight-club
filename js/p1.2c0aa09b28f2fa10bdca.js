(()=>{"use strict";const n={account:{name:"",src:"",wins:0,losses:0,health:100,fullHealth:100,attack:20,critChance:25,critMultiplier:1.5,attackCount:1,blockCount:2},enemy:{name:"",src:"",health:0,fullHealth:0,attack:0,critChance:0,critMultiplier:0,attackCount:0,blockCount:0},logs:[]},e=[{id:0,src:"./assets/images/avatars/afrodita.png"},{id:1,src:"./assets/images/avatars/apollon.png"},{id:2,src:"./assets/images/avatars/demetra.png"},{id:3,src:"./assets/images/avatars/gera.png"},{id:4,src:"./assets/images/avatars/poseidon.png"},{id:5,src:"./assets/images/avatars/zevs.png"},{id:6,src:"./assets/images/avatars/herakl.png"},{id:7,src:"./assets/images/avatars/helios.png"}],a=[{id:0,name:"Kentavr",health:100,fullHealth:100,attack:20,critChance:20,critMultiplier:1.5,attackCount:1,blockCount:3,src:"./assets/images/enemies/kentavr.png"},{id:1,name:"Meduza",health:130,fullHealth:130,attack:8,critChance:30,critMultiplier:1,attackCount:3,blockCount:2,src:"./assets/images/enemies/meduza.png"},{id:2,name:"Ziklop",health:200,fullHealth:200,attack:5,critChance:50,critMultiplier:2,attackCount:1,blockCount:3,src:"./assets/images/enemies/ziklop.png"},{id:3,name:"Lion",health:90,fullHealth:90,attack:10,critChance:60,critMultiplier:1.5,attackCount:2,blockCount:2,src:"./assets/images/enemies/lion.png"}],t=["head","neck","body","belly","legs"],s="gameState";function c(){return JSON.parse(localStorage.getItem(s))||structuredClone(n)}function l(n){localStorage.setItem(s,JSON.stringify(n))}function i(){const e=c(),t=a[Math.floor(Math.random()*a.length)],s={...n,account:{...e.account,health:100},enemy:t,logs:[]};return l(s),s}function o(n,e,a,t,s){const c=document.getElementById("resultModal"),i=Math.floor(100*Math.random())+1,o=s?t.account.critChance:t.enemy.critChance,d=s?a:t.enemy,r={isPlayerAttackPhase:s,playerName:a.name,enemyName:t.enemy.name,damage:0,hasCrit:!1,attackZone:n,hasDefense:!1};e.includes(n)&&(r.hasDefense=!0),o>=i?(r.hasCrit=!0,r.damage=d.attack*d.critMultiplier):r.hasDefense||(r.damage=d.attack),s?t.enemy.health-=r.damage:a.health-=r.damage,t.enemy.health<=0||a.health<=0?(t.enemy.health<=0&&(t.account.wins++,c.style.display="block",c.querySelector("h2").textContent="You win!",c.querySelector("img").src="./assets/images/losses/lion.png"),a.health<=0&&(t.account.losses++,c.style.display="block",c.querySelector("h2").textContent="You lose!",c.querySelector("img").src="./assets/images/losses/meduza.png")):t.logs.push(r),l(t)}function d(n,e){return n.sort(()=>Math.random()-.5).slice(0,e)}const r={"#/login":function(t){const s=c();s.account.name?window.location.hash="#/home":(t.innerHTML=`\n        <div class="page">\n            <div class="login">\n                <div class="login__box">\n                    <h1>Create your character</h1>\n                    <input id="playerName" placeholder="Character name" value="${s.account.name}">\n                    <button class="login__btn" id="startBtn">Create</button>\n                </div>\n            </div>\n        </div>\n    `,document.getElementById("startBtn").addEventListener("click",()=>{const t=document.getElementById("playerName").value.trim();t?(function(t){const s=e[Math.floor(Math.random()*e.length)],c=a[Math.floor(Math.random()*a.length)];l({...n,account:{name:t,wins:0,losses:0,health:100,fullHealth:100,attack:20,critChance:25,critMultiplier:1.5,attackCount:1,blockCount:2,src:s.src},enemy:c,logs:[]})}(t),window.location.hash="#/home"):alert("Введите имя!")}))},"#/home":function(n){c().account.name?n.innerHTML='\n        \n        <header class="header">\n            <div class="header__box">\n                <div class="header__logo">Not Fight Club</div>\n                \n                <ul class="header__ul">\n                    <li class="header__li" onclick="window.location.hash = \'#/home\'">\n                        <img src="./assets/images/icons/home.png" alt="page home image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = \'#/avatar\'">\n                        <img src="./assets/images/icons/user.png" alt="page character image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = \'#/settings\'">\n                        <img src="./assets/images/icons/setting.png" alt="page settings image" >\n                    </li>\n                </ul>\n            </div>\n        </header>\n    \n        \n        <div class="page">\n            <div class="home">\n                <div class="home__box">\n                    <main>\n                        <button class="home__btn-fight" onclick="window.location.hash = \'#/battle\'">fight !!!</button>\n                    </main>\n                </div>\n            </div>\n        </div>\n    ':window.location.hash="#/login"},"#/avatar":function(n){const a=c();if(!a.account.name)return void(window.location.hash="#/login");n.innerHTML=`\n        \n        <header class="header">\n            <div class="header__box">\n                <div class="header__logo">Not Fight Club</div>\n                \n                <ul class="header__ul">\n                    <li class="header__li" onclick="window.location.hash = '#/home'">\n                        <img src="./assets/images/icons/home.png" alt="page home image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/avatar'">\n                        <img src="./assets/images/icons/user.png" alt="page character image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/settings'">\n                        <img src="./assets/images/icons/setting.png" alt="page settings image" >\n                    </li>\n                </ul>\n            </div>\n        </header>\n    \n        \n        <div class="page">\n            <div class="character">\n                <div class="character__box">\n                \n                    <div class="character__left" style="background-image: url(${a.account.src})">\n                      <div class="change">\n                        <button class="change__btn" id="changeBtn">change</button>\n                      </div>\n                    </div>\n                    \n                    <div class="character__right stats">\n                        <div class="stats__row">\n                            <div class="stats__title">Name: </div>\n                            <div class="stats__desc">${a.account.name}</div>\n                        </div>\n                        \n                        <div class="stats__row">\n                            <div class="stats__title">Wins: </div>\n                            <div class="stats__desc">${a.account.wins}</div>\n                        </div>\n                        \n                        <div class="stats__row">\n                            <div class="stats__title">Loses: </div>\n                            <div class="stats__desc">${a.account.losses}</div>\n                        </div>\n                       \n                   \n                    </div>\n                </div>\n            </div>\n            \n            <div id="avatarModal" class="modal">\n              <div class="modal-content">\n                <span id="closeModal" class="close">&times;</span>\n                <h2>Выберите персонажа</h2>\n                <div id="characterList" class="character-list"></div>\n              </div>\n            </div>\n        </div>\n    `;const t=document.getElementById("changeBtn"),s=document.getElementById("avatarModal"),i=document.getElementById("characterList"),o=document.getElementById("closeModal");window.onclick=function(n){n.target===s&&(s.style.display="none")},o.onclick=function(){s.style.display="none"},t.onclick=function(){i.innerHTML="",e.forEach(n=>{const e=document.createElement("img");e.src=n.src,e.alt=`Character ${n.id}`,n.src===a.account.src?e.classList.add("active"):e.onclick=function(){a.account={...a.account,src:n.src},l(a),s.style.display="none",function(){const n=document.querySelector(".character__left");n&&a.account.src&&(n.style.backgroundImage=`url(${a.account.src})`)}()},i.appendChild(e)}),s.style.display="block"}},"#/settings":function(n){let e=c();if(!e.account.name)return void(window.location.hash="#/login");n.innerHTML=`\n        \n        <header class="header">\n            <div class="header__box">\n                <div class="header__logo">Not Fight Club</div>\n                \n                <ul class="header__ul">\n                    <li class="header__li" onclick="window.location.hash = '#/home'">\n                        <img src="./assets/images/icons/home.png" alt="page home image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/avatar'">\n                        <img src="./assets/images/icons/user.png" alt="page character image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/settings'">\n                        <img src="./assets/images/icons/setting.png" alt="page settings image" >\n                    </li>\n                </ul>\n            </div>\n        </header>\n    \n        \n        <div class="page">\n            <div class="settings">\n                <div class="settings__box">\n\n                    <main>\n                        <h1>Настройки</h1>\n                        \n                        <div class="settings__row">\n                            <label for="nameInput">Имя игрока:</label>\n                            <input id="nameInput" type="text" value="${e.account.name}">\n                            <button class="settings__btn" id="saveNameBtn" disabled>Сохранить</button>\n                        </div>\n                        \n                    </main>\n                </div>\n            </div>\n        </div>\n    `;const a=document.getElementById("nameInput"),t=document.getElementById("saveNameBtn");a.addEventListener("input",()=>{const n=a.value.trim();t.disabled=!n||n===e.account.name}),document.getElementById("saveNameBtn").addEventListener("click",()=>{const n=a.value.trim();n?(e=function(n){let e=c();return e.account.name=n,l(e),e}(n),t.disabled=!0,alert("Имя сохранено!")):alert("Имя не может быть пустым!")})},"#/battle":function(n){let e=c();if(!e.account.name)return void(window.location.hash="#/login");n.innerHTML=`\n        \n        <header class="header">\n            <div class="header__box">\n                <div class="header__logo">Not Fight Club</div>\n                \n                <ul class="header__ul">\n                    <li class="header__li" onclick="window.location.hash = '#/home'">\n                        <img src="./assets/images/icons/home.png" alt="page home image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/avatar'">\n                        <img src="./assets/images/icons/user.png" alt="page character image" >\n                    </li>\n                    <li class="header__li" onclick="window.location.hash = '#/settings'">\n                        <img src="./assets/images/icons/setting.png" alt="page settings image" >\n                    </li>\n                </ul>\n            </div>\n        </header>\n    \n        \n        <div class="page">\n            <div class="battle">\n                <div class="battle__box">\n\n                    <main>\n                        <div class="battle__row">\n                            <div class="battle__player">\n                                <div class="battle__name">${e.account.name}</div>\n                                <img src="${e.account.src}" alt="player image" class="character" width="230px">\n                                    <div class="line"></div>\n                                    <div class="health-text">\n                                        <span id="playerHP"> ${e.account.health} / 100</span>\n                                    </div>\n                            </div>   \n                         \n                            \n                            <div class="zones" id="zones">\n                                <h3>Please pick 1 Attack zone and 2 Defence zones</h3> \n                                <div class="zones__box"> \n                                    <div class="zones__attack">\n                                        <h4>1 Attack zone</h4> \n                                        <div id="attackZones"> \n                                            <label for="attachHead">\n                                                <input type="radio" name="attach" value="head" id="attachHead">\n                                                <span class="check"></span> \n                                                <span>head</span>\n                                            </label>\n                                            \n                                            <label for="attachNeck">\n                                                <input type="radio" name="attach" value="neck" id="attachNeck">\n                                                <span class="check"></span> \n                                                <span>neck</span> \n                                            </label> \n                                            \n                                            <label for="attachBody">\n                                                <input type="radio" name="attach" value="body" id="attachBody"> \n                                                <span class="check"></span>\n                                                <span>body</span> \n                                            </label> \n                                            \n                                            <label for="attachBelly">\n                                                <input type="radio" name="attach" value="belly" id="attachBelly">\n                                                <span class="check"></span>\n                                                <span>belly</span> \n                                            </label>\n                                             \n                                             <label for="attachLegs">\n                                                <input type="radio" name="attach" value="legs" id="attachLegs">\n                                                <span class="check"></span> \n                                                <span>legs</span> \n                                            </label> \n                                        </div> \n                                    </div> \n                                    \n                                    <div class="zones__defense"> \n                                    \n                                    <h4>2 Defence zones</h4> \n                                    \n                                    <div id="defenseZones"> \n                                   \n                                        <label for="defenseHead">\n                                            <input type="checkbox" name="defense" value="head" id="defenseHead">\n                                            <span class="checkbox"></span>\n                                            <span>head</span>\n                                        </label>\n                                      \n                                        <label for="defenseNeck"> \n                                            <input type="checkbox" name="defense" value="neck" id="defenseNeck">\n                                             <span class="checkbox"></span>\n                                             <span>neck</span> \n                                        </label>\n                                         \n                                        <label for="defenseBody"> \n                                            <input type="checkbox" name="defense" value="body" id="defenseBody">\n                                            <span class="checkbox"></span>\n                                            <span>body</span> \n                                        </label> \n                                        \n                                        <label for="defenseBelly">\n                                            <input type="checkbox" name="defense" value="belly" id="defenseBelly">\n                                            <span class="checkbox"></span>\n                                            <span>belly</span> \n                                        </label> \n                                        \n                                        <label for="defenseLegs">\n                                            <input type="checkbox" name="defense" value="legs" id="defenseLegs">\n                                            <span class="checkbox"></span>\n                                            <span>legs</span> \n                                        </label> \n                                    \n                                    </div>\n                                </div> \n                            </div> \n                        \n                            <div class="zones__btn">\n                                <button id="attackBtn" disabled>Attach !!!</button> \n                            </div> \n                        </div>\n                            \n                            <div class="battle__enemies">\n                                <div class="battle__name">${e.enemy.name}</div>\n                                <img src="${e.enemy.src}" alt="player image" class="character" width="230px">\n                            \n                                <div>\n                                    <div class="line"></div>\n                                    <div class="health-text"><span id="enemyHP">${e.enemy.health} / ${e.enemy.fullHealth}</span>\n                                </div>\n                            </div>\n                          \n                        </div>\n                        </div>\n                    </main>\n                    \n                    <footer>\n                      <div class="battle__logs" id="battleLog"></div>   \n                    </footer>\n                </div>\n            </div>\n            \n            <div id="resultModal" class="modal">\n              <div class="modal-content">\n                <span id="closeModal" class="close">&times;</span>\n                <h2>Win </h2>\n                \n                <div class="modal__img">\n                    <img src="./assets/images/losses/meduza.png" width="260" alt="Image winner" >\n                </div>\n              </div>\n            </div>\n        </div>\n    `;const a=document.getElementById("battleLog"),s=document.getElementById("resultModal"),l=document.getElementById("closeModal"),r=document.documentElement;function h(){const n=a.children.length/2,t=e.logs?.slice(n);r.style.setProperty("--player-health",e.account.health+"%"),r.style.setProperty("--enemy-health",Math.floor(e.enemy.health/e.enemy.fullHealth*100)+"%"),t.forEach((n,e)=>{const t=document.createElement("div"),s=document.createElement("div");s.classList.add("right");const c=n.isPlayerAttackPhase?n.playerName:n.enemyName,l=n.isPlayerAttackPhase?n.enemyName:n.playerName;n.hasCrit||n.hasDefense?!n.hasCrit&&n.hasDefense?t.innerHTML=`\n                    <div class="message">\n                         <span><span class="red">${c}</span> attacked \n                         <span class="red">${l}</span> but was able to block.\n                    </div>\n                `:t.innerHTML=`\n                    <div class="message">\n                         <span><span class="red">${c}</span> attacked \n                         <span class="red">${l}</span> to <span class="red">${n.attackZone}</span> but ${l}\n                         was very lucky and crid his oppenent for <span class="red">${n.damage}</span> damage.\n                    </div>\n                `:t.innerHTML=`\n                    <div class="message">\n                         <span><span class="red">${c}</span> attacked \n                         <span class="red">${l}</span> to <span class="red">${n.attackZone}</span> and deal \n                         <span class="red">${n.damage}</span> damage.\n                    </div>\n                `,a.append(t),a.append(s),a.scrollTo({top:a.scrollHeight,behavior:"smooth"})})}!function(n){const a=document.getElementById("attackBtn"),s=document.querySelectorAll('#attackZones input[type="radio"]'),c=document.querySelectorAll('#defenseZones input[type="checkbox"]');function l(){const e=[...s].filter(n=>n.checked).length===n.attackCount,t=[...c].filter(n=>n.checked).length===n.blockCount;a.disabled=!(e&&t)}s.forEach(e=>{e.addEventListener("change",()=>{[...s].filter(n=>n.checked).length>n.attackCount&&(e.checked=!1),l()})}),c.forEach(e=>{e.addEventListener("change",()=>{[...c].filter(n=>n.checked).length>n.blockCount&&(e.checked=!1),l()})}),a.addEventListener("click",()=>{const a=document.getElementById("playerHP"),l=document.getElementById("enemyHP"),i=(r=e.enemy,{attackZones:d(t,r.attackCount),blockZones:d(t,r.blockCount)});var r;const m=[...c].filter(n=>n.checked).map(n=>n.value),u=Array.from(s).find(n=>n.checked)?.value;o(u,i.blockZones,n,e,!0),l.textContent=e.enemy.health+" / "+e.enemy.fullHealth,e.account.health<=0||e.enemy.health<=0||i.attackZones.forEach(t=>{e.account.health<=0||(o(t,m,n,e,!1),a.textContent=e.account.health+" / "+e.account.fullHealth)}),h()})}(e.account),h(),window.onclick=function(n){n.target===s&&(s.style.display="none",e=i(),window.location.hash="#/home")},l.onclick=function(){s.style.display="none",e=i(),window.location.hash="#/home"}}};function h(){if(!window.location.hash)return void(window.location.hash="#/login");const n=document.body,e=window.location.hash,a=r[e];n.innerHTML="",a?a(n):n.innerHTML='\n        <div class="page">\n            <div class="not-found">\n                <div class="not-found__box">\n                    <img class="not-found__img" src="./assets/images/atlant.png" alt="page not found image" >\n                    <h1>Page not found</h1>\n                    <button class="not-found__btn" onclick="window.location.hash = \'#/login\'">назад к персонажу</button>\n                </div>\n            </div>\n        </div>\n    '}!async function(){window.addEventListener("load",h),window.addEventListener("hashchange",h)}()})();